{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Posts{% endblock %}</h1>
  <form class="searchform" action="{{ url_for('blog.search')}}" method="post">
    <input type="text" name="searchbox" placeholder="Search.."}}">
  </form>
  {% if g.user %}
    <a class="action" href="{{ url_for('blog.create') }}">New</a>
  {% endif %}
{% endblock %}

{% block content %}
  {% if not posts|length %}
    <p> Sorry, no post to show...</p>
  {% else %}
    {% for post in posts %}
      <article class="post">
        <header>
          <div>
            <h1><a href="{{ url_for('blog.show', id=post['id']) }}">{{ post['title'] }}</a></h1>
            <div class="about">by {{ post['username'] }} on {{ post['created'].strftime('%Y-%m-%d') }}</div>
          </div>
          {% if g.user['id'] == post['author_id'] %}
            <a class="action" href="{{ url_for('blog.update', id=post['id']) }}">Edit</a>
          {% endif %}
        </header>
        <p class="body">{{ post['body'] }}</p>
        <p class="about">{{ post['likes'] }}   <a class="action" href="{{ url_for('.like', id=post['id']) }}">likes</a>, 
                        {{ post['unlikes'] }} <a class="action" href="{{ url_for('.unlike', id=post['id']) }}">unlikes</a>, 
                        {{ post['nr_comments'] }} <a class="action" href="{{ url_for('blog.show', id=post['id']) }}">comments</a>
                        </p>
      </article>
      {% if not loop.last %}
        <hr>
      {% endif %}
    {% endfor %}
    {% if pages > 1 %}
      <div class="pagination">
        <a href="{{ url_for('index', page=colors.prev_num) }}" class="{% if colors.page == 1 %}disabled{% endif %}">&laquo;</a>

        <!-- Loop through the number of pages to display a link for each-->
        {% for page in pages["tolist"] %}
          {% if page = pages["currentpage"] %}
            <a class="active" href="#">{page}</a>
          {% else %}
            <a href="{{ url_for('index', page=page) }}">{page}</a>
          {% endif %}
          <a href="#">&raquo;</a>
      </div>

      <p>
      Showing page {{ pages["currentpage"] }} of {{ pages["pages"] }}
      </p>

      {% endif %}
  {% endif %}
{% endblock %}
